\hypertarget{_n_n_8h_source}{}\doxysection{NN.\+h}
\label{_n_n_8h_source}\index{code/AI/NN.h@{code/AI/NN.h}}
\mbox{\hyperlink{_n_n_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#ifndef \_AI\_NN\_}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#define \_AI\_NN\_}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <concepts>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <typeinfo>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <random>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <limits>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <arrayfire.h>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}../logger.h"{}}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{namespace }AIExample \{}
\DoxyCodeLine{23 }
\DoxyCodeLine{31     \textcolor{keyword}{class }\mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network}{GeneticNeuralNetwork}} \{}
\DoxyCodeLine{32 }
\DoxyCodeLine{33     \textcolor{keyword}{public}:}
\DoxyCodeLine{34 }
\DoxyCodeLine{35         \textcolor{comment}{// Initialisers.}}
\DoxyCodeLine{36 }
\DoxyCodeLine{42         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_ae6ea48823c3b73a909e83865251d9f28}{initNetwork}}(\textcolor{keyword}{const} std::vector<unsigned int>\& sizeLayer, \textcolor{keywordtype}{float} rangeMin, \textcolor{keywordtype}{float} rangeMax);}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{comment}{// Constructors.}}
\DoxyCodeLine{46 }
\DoxyCodeLine{50         \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_afcbd93370999a776db8e4df1baf06780}{GeneticNeuralNetwork}}();}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 }
\DoxyCodeLine{53         \textcolor{comment}{// Observers.}}
\DoxyCodeLine{54 }
\DoxyCodeLine{59         \textcolor{keyword}{const} std::vector<af::array>* \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a798924c4d8a0535c52c2c4ddeaefc59c}{weights}}() \textcolor{keyword}{const};}
\DoxyCodeLine{60 }
\DoxyCodeLine{65         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_af931543ff24b54a1151590dad5801b07}{nLayers}}() \textcolor{keyword}{const};}
\DoxyCodeLine{66 }
\DoxyCodeLine{71         af::array \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a5174e0b3f3e9ef32128166d219bf16ac}{forwardPropagation}}(\textcolor{keyword}{const} af::array\& input);}
\DoxyCodeLine{72 }
\DoxyCodeLine{77         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_aa7125e6ec29c4ac56c52f15b6e41c563}{forwardPropagationMax}}(\textcolor{keyword}{const} af::array\& input);}
\DoxyCodeLine{78 }
\DoxyCodeLine{83         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a520c0899ddc4c34a7f1f427e60c95f84}{forwardPropagationMin}}(\textcolor{keyword}{const} af::array\& input);}
\DoxyCodeLine{84 }
\DoxyCodeLine{91         \textcolor{keyword}{template} <\textcolor{keyword}{typename} TInput, \textcolor{keyword}{typename} TOutput>}
\DoxyCodeLine{92         \textcolor{keyword}{requires} std::is\_arithmetic<TInput>::value \&\& std::is\_arithmetic<TOutput>::value}
\DoxyCodeLine{93         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a5f1c60f548e83fe1fd7ca0a5b0cec6a7}{forwardPropagation}}(\textcolor{keyword}{const} std::vector<TInput>\& input, TOutput* output, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\& outputSize);}
\DoxyCodeLine{94 }
\DoxyCodeLine{99         \textcolor{keyword}{template} <\textcolor{keyword}{typename} TInput>}
\DoxyCodeLine{100         \textcolor{keyword}{requires} std::is\_arithmetic<TInput>::value}
\DoxyCodeLine{101         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a8c73b72196f2b6206786924878b70d26}{forwardPropagationMax}}(\textcolor{keyword}{const} std::vector<TInput>\& input);}
\DoxyCodeLine{102 }
\DoxyCodeLine{107         \textcolor{keyword}{template} <\textcolor{keyword}{typename} TInput>}
\DoxyCodeLine{108         \textcolor{keyword}{requires} std::is\_arithmetic<TInput>::value}
\DoxyCodeLine{109         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a2358e031a4311e04afd40b3e06d89cef}{forwardPropagationMin}}(\textcolor{keyword}{const} std::vector<TInput>\& input);}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 }
\DoxyCodeLine{112         \textcolor{comment}{// Modifiers.}}
\DoxyCodeLine{113 }
\DoxyCodeLine{121         std::vector<af::array>* \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a798924c4d8a0535c52c2c4ddeaefc59c}{weights}}();}
\DoxyCodeLine{122 }
\DoxyCodeLine{127         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a048469701ebe5f1e38fae3538ba37254}{updateNLayers}}();}
\DoxyCodeLine{128 }
\DoxyCodeLine{133         \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network}{GeneticNeuralNetwork}}\& \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a3dc9cfa94f185525249a3884df752d0e}{operator= }}(\textcolor{keyword}{const} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network}{GeneticNeuralNetwork}}\& source);}
\DoxyCodeLine{134 }
\DoxyCodeLine{135     \textcolor{keyword}{private}:}
\DoxyCodeLine{136 }
\DoxyCodeLine{137         \textcolor{comment}{// Attributes.}}
\DoxyCodeLine{138         }
\DoxyCodeLine{139         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nLayers\_;}
\DoxyCodeLine{140         std::vector<af::array> weights\_;}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 }
\DoxyCodeLine{143         \textcolor{comment}{// Methods.}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145         af::array addBias(\textcolor{keyword}{const} af::array\& A);}
\DoxyCodeLine{146 }
\DoxyCodeLine{147         \textcolor{comment}{// NOTE. Backward propagation won't be implemented here due to the fact that }}
\DoxyCodeLine{148         \textcolor{comment}{// this neural networks will be trained with genetic algorithms. Because}}
\DoxyCodeLine{149         \textcolor{comment}{// of this, the backpropagation from the output layer error through the}}
\DoxyCodeLine{150         \textcolor{comment}{// network is not needed in this case.}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \};}
\DoxyCodeLine{153 }
\DoxyCodeLine{154     \textcolor{keyword}{inline} \textcolor{keyword}{const} std::vector<af::array>* \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a798924c4d8a0535c52c2c4ddeaefc59c}{GeneticNeuralNetwork::weights}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{155     }
\DoxyCodeLine{156         \textcolor{keywordflow}{return} \&weights\_;}
\DoxyCodeLine{157     }
\DoxyCodeLine{158     \}}
\DoxyCodeLine{159 }
\DoxyCodeLine{160     \textcolor{keyword}{inline} std::vector<af::array>* \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a798924c4d8a0535c52c2c4ddeaefc59c}{GeneticNeuralNetwork::weights}}() \{}
\DoxyCodeLine{161     }
\DoxyCodeLine{162         \textcolor{keywordflow}{return} \&weights\_;}
\DoxyCodeLine{163     }
\DoxyCodeLine{164     \}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166     \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_af931543ff24b54a1151590dad5801b07}{GeneticNeuralNetwork::nLayers}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{167     }
\DoxyCodeLine{168         \textcolor{keywordflow}{return} nLayers\_;}
\DoxyCodeLine{169     }
\DoxyCodeLine{170     \}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a048469701ebe5f1e38fae3538ba37254}{GeneticNeuralNetwork::updateNLayers}}() \{}
\DoxyCodeLine{173     }
\DoxyCodeLine{174         nLayers\_ = weights\_.size() + 1;}
\DoxyCodeLine{175     }
\DoxyCodeLine{176     \}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178     \textcolor{keyword}{template} <\textcolor{keyword}{typename} TInput, \textcolor{keyword}{typename} TOutput>}
\DoxyCodeLine{179     \textcolor{keyword}{requires} std::is\_arithmetic<TInput>::value \&\& std::is\_arithmetic<TOutput>::value}
\DoxyCodeLine{180     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a5174e0b3f3e9ef32128166d219bf16ac}{GeneticNeuralNetwork::forwardPropagation}}(\textcolor{keyword}{const} std::vector<TInput>\& input, TOutput* output, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\& outputSize) \{}
\DoxyCodeLine{181 }
\DoxyCodeLine{182         \textcolor{comment}{// Process input through each layer and return the values at the output layer.}}
\DoxyCodeLine{183         af::array values;}
\DoxyCodeLine{184 }
\DoxyCodeLine{185         values.write<TInput>(input.data(), input.size());}
\DoxyCodeLine{186         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nLayers\_ -\/ 1; i++)}
\DoxyCodeLine{187             values = af::sigmoid(af::matmul(addBias(values), weights\_[i]));}
\DoxyCodeLine{188 }
\DoxyCodeLine{189         output = values.host<TOutput>();}
\DoxyCodeLine{190         outputSize = values.elements();}
\DoxyCodeLine{191 }
\DoxyCodeLine{192     \}}
\DoxyCodeLine{193 }
\DoxyCodeLine{194     \textcolor{keyword}{template} <\textcolor{keyword}{typename} TInput>}
\DoxyCodeLine{195     \textcolor{keyword}{requires} std::is\_arithmetic<TInput>::value}
\DoxyCodeLine{196     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_aa7125e6ec29c4ac56c52f15b6e41c563}{GeneticNeuralNetwork::forwardPropagationMax}}(\textcolor{keyword}{const} std::vector<TInput>\& input) \{}
\DoxyCodeLine{197 }
\DoxyCodeLine{198         af::dtype type;}
\DoxyCodeLine{199         \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(TInput) == \textcolor{keyword}{typeid}(\textcolor{keywordtype}{int}))}
\DoxyCodeLine{200             type = af::dtype::s32;}
\DoxyCodeLine{201         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(TInput) == \textcolor{keyword}{typeid}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}))}
\DoxyCodeLine{202             type = af::dtype::u32;}
\DoxyCodeLine{203         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(TInput) == \textcolor{keyword}{typeid}(\textcolor{keywordtype}{float}))}
\DoxyCodeLine{204             type = af::dtype::f32;}
\DoxyCodeLine{205         \textcolor{keywordflow}{else}}
\DoxyCodeLine{206             \mbox{\hyperlink{class_voxel_eng_1_1logger_a71bf58e041bae58e2ff5be50cd11e382}{VoxelEng::logger::errorLog}}(\textcolor{stringliteral}{"{}Unknown type used!"{}});}
\DoxyCodeLine{207 }
\DoxyCodeLine{208 }
\DoxyCodeLine{209         \textcolor{comment}{// Process input through each layer and return the values at the output layer.}}
\DoxyCodeLine{210         af::array values(1, input.size(), type),}
\DoxyCodeLine{211                   indices;}
\DoxyCodeLine{212 }
\DoxyCodeLine{213         values.write<TInput>(input.data(), input.size() * \textcolor{keyword}{sizeof}(TInput));}
\DoxyCodeLine{214 }
\DoxyCodeLine{215         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nLayers\_ -\/ 1; i++)}
\DoxyCodeLine{216             values = af::sigmoid(af::matmul(addBias(values).as(af::dtype::f32), weights\_[i]));}
\DoxyCodeLine{217 }
\DoxyCodeLine{218         af::max(values, indices, values);}
\DoxyCodeLine{219 }
\DoxyCodeLine{220         \textcolor{keywordflow}{return} indices.scalar<\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}>();}
\DoxyCodeLine{221 }
\DoxyCodeLine{222     \}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224     \textcolor{keyword}{template} <\textcolor{keyword}{typename} TInput>}
\DoxyCodeLine{225     \textcolor{keyword}{requires} std::is\_arithmetic<TInput>::value}
\DoxyCodeLine{226     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_a_i_example_1_1_genetic_neural_network_a520c0899ddc4c34a7f1f427e60c95f84}{GeneticNeuralNetwork::forwardPropagationMin}}(\textcolor{keyword}{const} std::vector<TInput>\& input) \{}
\DoxyCodeLine{227 }
\DoxyCodeLine{228         \textcolor{comment}{// Process input through each layer and return the values at the output layer.}}
\DoxyCodeLine{229         af::array values,}
\DoxyCodeLine{230                   indices;}
\DoxyCodeLine{231 }
\DoxyCodeLine{232         values.write<TInput>(input.data(), input.size());}
\DoxyCodeLine{233         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nLayers\_ -\/ 1; i++)}
\DoxyCodeLine{234             values = af::sigmoid(af::matmul(addBias(values), weights\_[i]));}
\DoxyCodeLine{235 }
\DoxyCodeLine{236         af::min(values, indices, values);}
\DoxyCodeLine{237 }
\DoxyCodeLine{238         \textcolor{keywordflow}{return} indices.scalar<\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}>();}
\DoxyCodeLine{239 }
\DoxyCodeLine{240     \}}
\DoxyCodeLine{241 }
\DoxyCodeLine{242 \}}
\DoxyCodeLine{243 }
\DoxyCodeLine{244 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
